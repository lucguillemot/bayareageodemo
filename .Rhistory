"Owner-occupied", "With interests",
"Per capita income", "Unemployment",
"Poor and Struggling", "Very wealthy")
names(stcl.means.dev) <- Namen
View(stcl.means.dev)
# Remove 'cluster' column
stcl.means.dev <- stcl.means.dev[,-1]
View(stcl.means.dev)
Namen <- c("Density", "One Unit",
"Public Transit", "Less than High School",
"Some college", "PhD holder",
"Married couple", "With kids",
"Same-sex couples", "Males",
"Median age", "Whites",
"Blacks", "Asian",
"Hispanic", "Foreign-born",
"Owner-occupied", "With interests",
"Per capita income", "Unemployment",
"Poor and Struggling", "Very wealthy")
names(stcl.means.dev) <- Namen
View(stcl.means.dev)
i <- 1
stcl.means.dev.i <- stcl.means.dev[i,]+0.5
View(stcl.means.dev.i)
stcl.means.dev.i.melted <- melt(stcl.means.dev.i)
View(stcl.means.dev.i.melted)
names(stcl.means.dev.i.melted) <- c("axis", "value")
View(stcl.means.dev.i.melted)
json.list[[i]] <- stcl.means.dev.i.melted
json.list <- list()
json.list[[i]] <- stcl.means.dev.i.melted
for (i in 1:nclass) { # 10 classes
# Artificially add .5 to facilitate the creation of the radar plot in D3
stcl.means.dev.i <- stcl.means.dev[i,]+0.5
stcl.means.dev.i.melted <- melt(stcl.means.dev.i)
names(stcl.means.dev.i.melted) <- c("axis", "value")
json.list[[i]] <- stcl.means.dev.i.melted
}
# Export all clusters in one json file
write(toJSON(json.list, pretty = T), "data/radar/radar.json")
# Export each cluster in a separate json file
for (i in 1:nclass) {
write(paste("[", toJSON(json.list[[i]], pretty = T), "]", sep = ""), paste("data/radar/radar-cl", i, ".json", sep = ""))
}
# Export all clusters in one json file
write(toJSON(json.list, pretty = T), "data/radar/radar.json")
# Export each cluster in a separate json file
for (i in 1:nclass) {
write(paste("[", toJSON(json.list[[i]], pretty = T), "]", sep = ""), paste("data/radar/radar-cl-", i, ".json", sep = ""))
}
# Export all clusters in one json file
write(toJSON(json.list, pretty = T), "data/radar/radar.json")
# Export each cluster in a separate json file
for (i in 1:nclass) {
write(paste("[", toJSON(json.list[[i]], pretty = T), "]", sep = ""), paste("data/radar/radar-cl-", i, ".json", sep = ""))
}
source("data/util.R")
source("data/util.R")
for (i in 1:length(years)) {
# Create a data frame with variables for each year
sfbact.cc <- paste("sfbact.cc.", years[i], sep = "")
assign(sfbact.cc,
readAndParse(years[i], files[i]),
env = .GlobalEnv)
# Standardize data (square root + range standardization)
sfbact.cc.st <- paste("sfbact.cc.st.", years[i], sep = "")
cc <- get(paste("sfbact.cc.", years[i], sep = ""))
assign(sfbact.cc.st,
standardizeData(cc),
env = .GlobalEnv)
# Perform hierarchical clustering
sfbact.hc.cl <- paste("sfbact.hc.cl.", years[i], sep = "")
st <- get(paste("sfbact.cc.st.", years[i], sep = ""))
assign(sfbact.hc.cl,
clusteringByYear(st),
env = .GlobalEnv)
# Calculate means, distances to the mean
# and export data for the radar plot
radarPlotData(st, sfbact.hc.cl)
}
source("data/util.R")
for (i in 1:length(years)) {
# Create a data frame with variables for each year
sfbact.cc <- paste("sfbact.cc.", years[i], sep = "")
assign(sfbact.cc,
readAndParse(years[i], files[i]),
env = .GlobalEnv)
# Standardize data (square root + range standardization)
sfbact.cc.st <- paste("sfbact.cc.st.", years[i], sep = "")
cc <- get(paste("sfbact.cc.", years[i], sep = ""))
assign(sfbact.cc.st,
standardizeData(cc),
env = .GlobalEnv)
# Perform hierarchical clustering
sfbact.hc.cl <- paste("sfbact.hc.cl.", years[i], sep = "")
st <- get(paste("sfbact.cc.st.", years[i], sep = ""))
assign(sfbact.hc.cl,
clusteringByYear(st),
env = .GlobalEnv)
# Calculate means, distances to the mean
# and export data for the radar plot
radarPlotData(st, sfbact.hc.cl)
}
source("data/util.R")
for (i in 1:length(years)) {
# Create a data frame with variables for each year
sfbact.cc <- paste("sfbact.cc.", years[i], sep = "")
assign(sfbact.cc,
readAndParse(years[i], files[i]),
env = .GlobalEnv)
# Standardize data (square root + range standardization)
sfbact.cc.st <- paste("sfbact.cc.st.", years[i], sep = "")
cc <- get(paste("sfbact.cc.", years[i], sep = ""))
assign(sfbact.cc.st,
standardizeData(cc),
env = .GlobalEnv)
# Perform hierarchical clustering
sfbact.hc.cl <- paste("sfbact.hc.cl.", years[i], sep = "")
st <- get(paste("sfbact.cc.st.", years[i], sep = ""))
assign(sfbact.hc.cl,
clusteringByYear(st),
env = .GlobalEnv)
# Calculate means, distances to the mean
# and export data for the radar plot
}
radarPlotData(sfbact.cc.st.2014, sfbact.hc.cl.2014)
for (i in 1:length(years)) {
# Create a data frame with variables for each year
sfbact.cc <- paste("sfbact.cc.", years[i], sep = "")
assign(sfbact.cc,
readAndParse(years[i], files[i]),
env = .GlobalEnv)
# Standardize data (square root + range standardization)
sfbact.cc.st <- paste("sfbact.cc.st.", years[i], sep = "")
cc <- get(paste("sfbact.cc.", years[i], sep = ""))
assign(sfbact.cc.st,
standardizeData(cc),
env = .GlobalEnv)
# Perform hierarchical clustering
sfbact.hc.cl <- paste("sfbact.hc.cl.", years[i], sep = "")
st <- get(paste("sfbact.cc.st.", years[i], sep = ""))
assign(sfbact.hc.cl,
clusteringByYear(st),
env = .GlobalEnv)
# Calculate means, distances to the mean
# and export data for the radar plot
cl <- get(paste("sfbact.hc.cl.", years[i], sep = ""))
radarPlotData(st, cl)
}
source("data/util.R")
for (i in 1:length(years)) {
# Create a data frame with variables for each year
sfbact.cc <- paste("sfbact.cc.", years[i], sep = "")
assign(sfbact.cc,
readAndParse(years[i], files[i]),
env = .GlobalEnv)
# Standardize data (square root + range standardization)
sfbact.cc.st <- paste("sfbact.cc.st.", years[i], sep = "")
cc <- get(paste("sfbact.cc.", years[i], sep = ""))
assign(sfbact.cc.st,
standardizeData(cc),
env = .GlobalEnv)
# Perform hierarchical clustering
sfbact.hc.cl <- paste("sfbact.hc.cl.", years[i], sep = "")
st <- get(paste("sfbact.cc.st.", years[i], sep = ""))
assign(sfbact.hc.cl,
clusteringByYear(st),
env = .GlobalEnv)
# Calculate means, distances to the mean
# and export data for the radar plot
cl <- get(paste("sfbact.hc.cl.", years[i], sep = ""))
radarPlotData(st, cl, years[i])
}
source("data/util.R")
for (i in 1:length(years)) {
# Create a data frame with variables for each year
sfbact.cc <- paste("sfbact.cc.", years[i], sep = "")
assign(sfbact.cc,
readAndParse(years[i], files[i]),
env = .GlobalEnv)
# Standardize data (square root + range standardization)
sfbact.cc.st <- paste("sfbact.cc.st.", years[i], sep = "")
cc <- get(paste("sfbact.cc.", years[i], sep = ""))
assign(sfbact.cc.st,
standardizeData(cc),
env = .GlobalEnv)
# Perform hierarchical clustering
sfbact.hc.cl <- paste("sfbact.hc.cl.", years[i], sep = "")
st <- get(paste("sfbact.cc.st.", years[i], sep = ""))
assign(sfbact.hc.cl,
clusteringByYear(st),
env = .GlobalEnv)
# Calculate means, distances to the mean
# and export data for the radar plot
cl <- get(paste("sfbact.hc.cl.", years[i], sep = ""))
radarPlotData(st, cl, years[i])
}
source("data/util.R")
for (i in 1:length(years)) {
# Create a data frame with variables for each year
sfbact.cc <- paste("sfbact.cc.", years[i], sep = "")
assign(sfbact.cc,
readAndParse(years[i], files[i]),
env = .GlobalEnv)
# Standardize data (square root + range standardization)
sfbact.cc.st <- paste("sfbact.cc.st.", years[i], sep = "")
cc <- get(paste("sfbact.cc.", years[i], sep = ""))
assign(sfbact.cc.st,
standardizeData(cc),
env = .GlobalEnv)
# Perform hierarchical clustering
sfbact.hc.cl <- paste("sfbact.hc.cl.", years[i], sep = "")
st <- get(paste("sfbact.cc.st.", years[i], sep = ""))
assign(sfbact.hc.cl,
clusteringByYear(st),
env = .GlobalEnv)
# Calculate means, distances to the mean
# and export data for the radar plot
cl <- get(paste("sfbact.hc.cl.", years[i], sep = ""))
radarPlotData(st, cl, years[i])
}
source("data/util.R")
for (i in 1:length(years)) {
# Create a data frame with variables for each year
sfbact.cc <- paste("sfbact.cc.", years[i], sep = "")
assign(sfbact.cc,
readAndParse(years[i], files[i]),
env = .GlobalEnv)
# Standardize data (square root + range standardization)
sfbact.cc.st <- paste("sfbact.cc.st.", years[i], sep = "")
cc <- get(paste("sfbact.cc.", years[i], sep = ""))
assign(sfbact.cc.st,
standardizeData(cc),
env = .GlobalEnv)
# Perform hierarchical clustering
sfbact.hc.cl <- paste("sfbact.hc.cl.", years[i], sep = "")
st <- get(paste("sfbact.cc.st.", years[i], sep = ""))
assign(sfbact.hc.cl,
clusteringByYear(st),
env = .GlobalEnv)
# Calculate means, distances to the mean
# and export data for the radar plot
cl <- get(paste("sfbact.hc.cl.", years[i], sep = ""))
mean.dist <- paste("sfba.hc.cl.mean.dist.", years[i], sep = "")
assign(mean.dist,
radarPlotData(st, cl, years[i]),
env = .GlobalEnv)
}
source("data/util.R")
for (i in 1:length(years)) {
# Create a data frame with variables for each year
sfbact.cc <- paste("sfbact.cc.", years[i], sep = "")
assign(sfbact.cc,
readAndParse(years[i], files[i]),
env = .GlobalEnv)
# Standardize data (square root + range standardization)
sfbact.cc.st <- paste("sfbact.cc.st.", years[i], sep = "")
cc <- get(paste("sfbact.cc.", years[i], sep = ""))
assign(sfbact.cc.st,
standardizeData(cc),
env = .GlobalEnv)
# Perform hierarchical clustering
sfbact.hc.cl <- paste("sfbact.hc.cl.", years[i], sep = "")
st <- get(paste("sfbact.cc.st.", years[i], sep = ""))
assign(sfbact.hc.cl,
clusteringByYear(st),
env = .GlobalEnv)
# Calculate means, distances to the mean
# and export data for the radar plot
cl <- get(paste("sfbact.hc.cl.", years[i], sep = ""))
cl.means <- paste("cl.means.", years[i], sep = "")
assign(cl.means,
radarPlotData(st, cl, years[i]),
env = .GlobalEnv)
}
cl.means.2014
source("data/util.R")
for (i in 1:length(years)) {
# Create a data frame with variables for each year
sfbact.cc <- paste("sfbact.cc.", years[i], sep = "")
assign(sfbact.cc,
readAndParse(years[i], files[i]),
env = .GlobalEnv)
# Standardize data (square root + range standardization)
sfbact.cc.st <- paste("sfbact.cc.st.", years[i], sep = "")
cc <- get(paste("sfbact.cc.", years[i], sep = ""))
assign(sfbact.cc.st,
standardizeData(cc),
env = .GlobalEnv)
# Perform hierarchical clustering
sfbact.hc.cl <- paste("sfbact.hc.cl.", years[i], sep = "")
st <- get(paste("sfbact.cc.st.", years[i], sep = ""))
assign(sfbact.hc.cl,
clusteringByYear(st),
env = .GlobalEnv)
# Calculate means, distances to the mean
# and export data for the radar plot
cl <- get(paste("sfbact.hc.cl.", years[i], sep = ""))
cl.means <- paste("cl.means.", years[i], sep = "")
assign(cl.means,
radarPlotData(st, cl, years[i]),
env = .GlobalEnv)
}
View(cl.means.2014)
View(cl.means.2014)
st <- sfbact.cc.st.2014
cl <- sfbact.hc.cl.2014
stcl <- inner_join(st,cl, by="Geo_FIPS")
View(stcl)
stcl$year <- NULL
stcl.means <- as.vector(apply(stcl[2:23], 2, mean))
stcl.means
stcl.means.cl <- stcl[2:24] %>%
group_by(cluster) %>%
summarise_each(funs(mean))
View(stcl.means.cl)
stcl.means.dev <- stcl.means.cl %>%
mutate(density=density-stcl.means[1],
PConeUnit=PConeUnit-stcl.means[2],
PCcommutingNotCar=PCcommutingNotCar-stcl.means[3],
PClessHighSchool=PClessHighSchool-stcl.means[4],
PCsomeCollegeOrMore=PCsomeCollegeOrMore-stcl.means[5],
PCdoctorate=PCdoctorate-stcl.means[6],
PCmarriedCouple=PCmarriedCouple-stcl.means[7],
PCwithKids=PCwithKids-stcl.means[8],
PCunmarriedSSCouple=PCunmarriedSSCouple-stcl.means[9],
PCsexMale=PCsexMale-stcl.means[10],
medianAge=medianAge-stcl.means[11],
PCraceWhiteAlone=PCraceWhiteAlone-stcl.means[12],
PCraceBlackAlone=PCraceBlackAlone-stcl.means[13],
PCraceAsianAlone=PCraceAsianAlone-stcl.means[14],
PCraceHispanic=PCraceHispanic-stcl.means[15],
PCforeignBorn=PCforeignBorn-stcl.means[16],
PCownerOccUnits=PCownerOccUnits-stcl.means[17],
PCwithInterests=PCwithInterests-stcl.means[18],
perCapitaIncome=perCapitaIncome-stcl.means[19],
PCunemployed=PCunemployed-stcl.means[20],
PCpoorStruggling=PCpoorStruggling-stcl.means[21],
PCveryWealthyHHolds=PCveryWealthyHHolds-stcl.means[22]
)
View(stcl.means.dev)
stcl.means
str(stcl.means.dev)
max(stcl.means.dev)
max(stcl.means.dev[2:23])
min(stcl.means.dev[2:23])
# Remove 'cluster' column
stcl.means.dev <- stcl.means.dev[,-1]
Namen <- c("Density", "One Unit",
"Public Transit", "Less than High School",
"Some college", "PhD holder",
"Married couple", "With kids",
"Same-sex couples", "Males",
"Median age", "Whites",
"Blacks", "Asian",
"Hispanic", "Foreign-born",
"Owner-occupied", "With interests",
"Per capita income", "Unemployment",
"Poor and Struggling", "Very wealthy")
names(stcl.means.dev) <- Namen
View(stcl.means.dev)
View(sfbact.cc.2014)
source("data/util.R")
for (i in 1:length(years)) {
# Create a data frame with variables for each year
sfbact.cc <- paste("sfbact.cc.", years[i], sep = "")
assign(sfbact.cc,
readAndParse(years[i], files[i]),
env = .GlobalEnv)
# Standardize data (square root + range standardization)
sfbact.cc.st <- paste("sfbact.cc.st.", years[i], sep = "")
cc <- get(paste("sfbact.cc.", years[i], sep = ""))
assign(sfbact.cc.st,
standardizeData(cc),
env = .GlobalEnv)
# Perform hierarchical clustering
sfbact.hc.cl <- paste("sfbact.hc.cl.", years[i], sep = "")
st <- get(paste("sfbact.cc.st.", years[i], sep = ""))
assign(sfbact.hc.cl,
clusteringByYear(st),
env = .GlobalEnv)
# Export csv data file with raw data + cluster number
# used in the d3 plot of raw variables
sfba.var.cl <- paste("sfba.var.cl.", years[i], sep = "")
var <- get(paste("sfbact.cc.", years[i], sep = ""))
clust <- get(paste("sfbact.hc.cl.", years[i], sep = ""))
assign(sfba.var.cl,
inner_join(var, clust, by = "Geo_FIPS"),
env = .GlobalEnv)
write.csv(sfba.var.cl,
file=paste("data/var/sfbact-var-",
years[i],
".csv",
sep=""))
# Calculate means, distances to the mean
# and export data for the radar plot
cl <- get(paste("sfbact.hc.cl.", years[i], sep = ""))
cl.means <- paste("cl.means.", years[i], sep = "")
assign(cl.means,
radarPlotData(st, cl, years[i]),
env = .GlobalEnv)
}
View(sfba.var.cl.2014)
source("data/util.R")
for (i in 1:length(years)) {
# Create a data frame with variables for each year
sfbact.cc <- paste("sfbact.cc.", years[i], sep = "")
assign(sfbact.cc,
readAndParse(years[i], files[i]),
env = .GlobalEnv)
# Standardize data (square root + range standardization)
sfbact.cc.st <- paste("sfbact.cc.st.", years[i], sep = "")
cc <- get(paste("sfbact.cc.", years[i], sep = ""))
assign(sfbact.cc.st,
standardizeData(cc),
env = .GlobalEnv)
# Perform hierarchical clustering
sfbact.hc.cl <- paste("sfbact.hc.cl.", years[i], sep = "")
st <- get(paste("sfbact.cc.st.", years[i], sep = ""))
assign(sfbact.hc.cl,
clusteringByYear(st),
env = .GlobalEnv)
# Export csv data file with raw data + cluster number
# used in the d3 plot of raw variables
sfba.var.cl <- paste("sfba.var.cl.", years[i], sep = "")
var <- get(paste("sfbact.cc.", years[i], sep = ""))
clust <- get(paste("sfbact.hc.cl.", years[i], sep = ""))
assign(sfba.var.cl,
exportVarData(var, clust, years[i]),
env = .GlobalEnv)
# Calculate means, distances to the mean
# and export data for the radar plot
cl <- get(paste("sfbact.hc.cl.", years[i], sep = ""))
cl.means <- paste("cl.means.", years[i], sep = "")
assign(cl.means,
radarPlotData(st, cl, years[i]),
env = .GlobalEnv)
}
View(sfbact.hc.cl.2014)
View(sfbact.hc.cl.2013)
View(sfbact.hc.cl.2012)
View(sfbact.hc.cl.2011)
source("data/util.R")
for (i in 1:length(years)) {
# Create a data frame with variables for each year
sfbact.cc <- paste("sfbact.cc.", years[i], sep = "")
assign(sfbact.cc,
readAndParse(years[i], files[i]),
env = .GlobalEnv)
# Standardize data (square root + range standardization)
sfbact.cc.st <- paste("sfbact.cc.st.", years[i], sep = "")
cc <- get(paste("sfbact.cc.", years[i], sep = ""))
assign(sfbact.cc.st,
standardizeData(cc),
env = .GlobalEnv)
# Perform hierarchical clustering
sfbact.hc.cl <- paste("sfbact.hc.cl.", years[i], sep = "")
st <- get(paste("sfbact.cc.st.", years[i], sep = ""))
assign(sfbact.hc.cl,
clusteringByYear(st, years[i]),
env = .GlobalEnv)
# Export csv data file with raw data + cluster number
# used in the d3 plot of raw variables
sfba.var.cl <- paste("sfba.var.cl.", years[i], sep = "")
var <- get(paste("sfbact.cc.", years[i], sep = ""))
clust <- get(paste("sfbact.hc.cl.", years[i], sep = ""))
assign(sfba.var.cl,
exportVarData(var, clust, years[i]),
env = .GlobalEnv)
# Calculate means, distances to the mean
# and export data for the radar plot
cl <- get(paste("sfbact.hc.cl.", years[i], sep = ""))
cl.means <- paste("cl.means.", years[i], sep = "")
assign(cl.means,
radarPlotData(st, cl, years[i]),
env = .GlobalEnv)
}
source("data/util.R")
for (i in 1:length(years)) {
# Create a data frame with variables for each year
sfbact.cc <- paste("sfbact.cc.", years[i], sep = "")
assign(sfbact.cc,
readAndParse(years[i], files[i]),
env = .GlobalEnv)
# Standardize data (square root + range standardization)
sfbact.cc.st <- paste("sfbact.cc.st.", years[i], sep = "")
cc <- get(paste("sfbact.cc.", years[i], sep = ""))
assign(sfbact.cc.st,
standardizeData(cc),
env = .GlobalEnv)
# Perform hierarchical clustering
sfbact.hc.cl <- paste("sfbact.hc.cl.", years[i], sep = "")
st <- get(paste("sfbact.cc.st.", years[i], sep = ""))
assign(sfbact.hc.cl,
clusteringByYear(st, years[i]),
env = .GlobalEnv)
# Export csv data file with raw data + cluster number
# used in the d3 plot of raw variables
sfba.var.cl <- paste("sfba.var.cl.", years[i], sep = "")
var <- get(paste("sfbact.cc.", years[i], sep = ""))
clust <- get(paste("sfbact.hc.cl.", years[i], sep = ""))
assign(sfba.var.cl,
exportVarData(var, clust, years[i]),
env = .GlobalEnv)
# Calculate means, distances to the mean
# and export data for the radar plot
cl <- get(paste("sfbact.hc.cl.", years[i], sep = ""))
cl.means <- paste("cl.means.", years[i], sep = "")
assign(cl.means,
radarPlotData(st, cl, years[i]),
env = .GlobalEnv)
}
